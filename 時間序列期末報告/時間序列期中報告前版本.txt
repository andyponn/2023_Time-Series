##### 時間數列分析 期中報告##### 組員：陳葳芃 楊岳錩##### 選用資料：2000-2023 台灣出生月人口數##### 資料來源：https://reurl.cc/XLzEGg##### 更新時間：0518library(readxl)df_birth <- read_excel("Desktop/1112-NCCU/時間序列期末報告/tw_birth(2000-2023)(1).xlsx")str(df_birth)plot(df_birth$time, df_birth$amount, main="Monthly number of births in Taiwan",type='l',xlab = "Year", ylab = "Number of births")library(tidyverse)df_birth$month <- as.factor(format(df_birth$time, "%m"))month_colors <- c("black","black","blue","black","black", "black","black","black","black","purple","orange","red")ggplot(df_birth, aes(x = time, y = amount)) +  geom_line() +  # 加入點的顯示  geom_point(aes(color = month), size = 1, shape = 21) +  # 在點上加上月份  geom_text(aes(label = month), hjust = -0.1, color = month_colors[df_birth$month],size = 5)+  scale_color_manual(values = month_colors) +  labs(x = "Year", y = "Number of births", title = "Monthly number of births in Taiwan")par(mfrow=c(1,2))acf(df_birth$amount, main="ACF",lag.max = 100)pacf(df_birth$amount, main="PACF",lag.max = 100)###1期 differencedata<-df_birth$amountdata_diff1<-diff(data)ts.plot(data_diff1, main="Time series after lag=1 difference",xlab = "Time", ylab = "Diff")  acf(data_diff1, main="ACF of lag=1 difference", lag.max = 100)pacf(data_diff1, main="PACF of lag=1 difference",lag.max = 100)###12期 differencedata_diff12<-diff(data, lag = 12)ts.plot(data_diff12, main="Time series after lag=12 difference",xlab = "Time", ylab = "Diff") par(mfrow=c(2,1)) acf(data_diff12, main="ACF of lag=12 difference", lag.max = 100)pacf(data_diff12, main="PACF of lag=12 difference", lag.max = 100)library(tseries)adf.test(data)adf.test(data_diff1)adf.test(data_diff12)###### diff=1 change lag partpar(mfrow=c(3,3)) lags <- paste0("lag", 1:12)acf <- paste0("acf", 1:12)pacf <- paste0("pacf", 1:12)for (i in 1:12){  print(i)  data_diff<-diff(data,lag = i)  ts.plot(data_diff ,xlab = "Time", ylab = "Diff",main = lags[i])  acf(data_diff ,xlab = "Time", ylab = "Diff", main = acf[i])  pacf(data_diff ,xlab = "Time", ylab = "Diff", main = pacf[i])}par(mfrow=c(3,4)) for (i in 1:12){  print(i)  data_diff<-diff(data,lag = i)  ts.plot(data_diff ,xlab = "Time", ylab = "Diff",main = lags[i])}###### lag=1 change diff partdifference <- paste0("difference", 1:12)acf <- paste0("acf", 1:12)pacf <- paste0("pacf", 1:12)par(mfrow=c(3,3)) for (i in 1:12){  print(i)  data_diff<-diff(data,difference = i)  ts.plot(data_diff ,xlab = "Time", ylab = "Diff",main = difference[i])  acf(data_diff ,xlab = "Time", ylab = "Diff", main = acf[i])  pacf(data_diff ,xlab = "Time", ylab = "Diff", main = pacf[i])}par(mfrow=c(3,4)) for (i in 1:12){  print(i)  data_diff<-diff(data,difference = i)  ts.plot(data_diff ,xlab = "Time", ylab = "Diff",main = difference[i])}trend<-lm(amount~c(1:length(amount))+c(1:length(amount))**2+c(1:length(amount))**3,data=df_birth)new_data<-df_birth$amount-trend$fitted.valuesdetrend<-residuals(trend)ts.plot(detrend)acf(detrend,lag=100)adf.test(new_data)2**2